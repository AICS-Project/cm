
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒãƒ©ã‚·ãƒ¡ãƒ¼ã‚«ãƒ¼ â€“ ã‚³ãƒ”ãƒšAIç‰ˆ</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    body{font-family:sans-serif;background:#f7f3ea;padding:20px;max-width:860px;margin:auto}
    h1{font-size:1.4em}
    label{font-weight:700;margin-top:1em;display:block}
    input,textarea{width:100%;font-size:1em;margin-top:.3em;border-radius:4px;border:1px solid #bbb;padding:.4em}
    textarea[readonly]{background:#f0f0f0}
    .event-block{display:flex;gap:4px;margin-bottom:.5em}
    .event-block input{flex:1}
    button{margin-top:1em;padding:.5em 1.2em;border:none;border-radius:6px;background:#6b8e23;color:#fff;font-weight:bold;cursor:pointer}
    button.small{padding:.3em .8em;font-size:.85em;background:#888}
    #preview{background:#fff;padding:25px;border:1px solid #ccc;margin-top:30px}
    #preview h2{font-size:24px;text-align:center;margin:0 0 10px}
    #preview p{margin:6px 0}
    ul{padding-left:20px;margin:6px 0}
  </style>
</head>
<body>
<h1>å®¶æ—å­¦ç¿’ä¼šãƒãƒ©ã‚·ãƒ¡ãƒ¼ã‚«ãƒ¼ â€“ ã‚³ãƒ”ãƒšAIç‰ˆ</h1>

<label>å¹´åº¦</label>
<input id="year" value="2025">

<label>é–‹å‚¬æ—¥ãƒ»åœ°åŸŸãƒ»ä¼šå ´ï¼ˆï¼‹è¿½åŠ å¯ï¼‰</label>
<div id="events"></div>
<button class="small" onclick="addEvent()">ï¼‹è¿½åŠ </button>

<label>å¯¾è±¡è€…</label>
<input id="target" placeholder="ä¾‹ï¼šç²¾ç¥ç–¾æ‚£ã‚’æŒã¤ã”å®¶æ—">

<label>è¬›åº§ã®ç›®çš„ï¼ˆè¤‡æ•°é¸æŠOKï¼‰</label>
<div>
  <label><input type="checkbox" name="purpose" value="å®‰å¿ƒ">å®‰å¿ƒ</label>
  <label><input type="checkbox" name="purpose" value="äº¤æµ">äº¤æµ</label>
  <label><input type="checkbox" name="purpose" value="åˆ¶åº¦æ´»ç”¨">åˆ¶åº¦æ´»ç”¨</label>
  <label><input type="checkbox" name="purpose" value="æœ¬äººç†è§£">æœ¬äººç†è§£</label>
</div>

<label>æ™‚é–“</label>
<input id="time" placeholder="13:30â€“16:30">

<label>å‚åŠ è²»</label>
<input id="price" placeholder="1,500å††ï¼ˆãƒ†ã‚­ã‚¹ãƒˆä»£å«ã‚€ï¼‰">

<button onclick="makePrompt()">ğŸ“ AIç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆ</button>
<textarea id="promptBox" rows="6" readonly></textarea>
<button class="small" onclick="copyPrompt()">ğŸ“‹ã‚³ãƒ”ãƒ¼</button>

<label>AIã®JSONè¿”ç­”ã‚’è²¼ä»˜</label>
<textarea id="aiReply" rows="6" placeholder="ã“ã“ã«AIã®JSONã‚’ãƒšãƒ¼ã‚¹ãƒˆ"></textarea>
<button onclick="applyAI()">ğŸ“¥è²¼ä»˜ï¼†åæ˜ </button>

<div id="preview">
  <h2 id="flyer-title">2025å¹´åº¦ å®¶æ—ã«ã‚ˆã‚‹å®¶æ—å­¦ç¿’ä¼š</h2>
  <p id="flyer-catch">ã¾ãŸç¬‘é¡”ã«ãªã‚Œã‚‹ã‚ˆã†ã«</p>
  <p id="flyer-body">æœ¬è¬›åº§ã¯ã€ç²¾ç¥ç–¾æ‚£ã‚’æŒã¤ã”å®¶æ—ã‚’å¯¾è±¡ã«ã€å®‰å¿ƒãƒ»äº¤æµã‚’ç›®çš„ã¨ã—ãŸå…¨5å›ã®é€£ç¶šè¬›åº§ã§ã™ã€‚</p>
  <ul id="flyer-events"><li>é–‹å‚¬æ—¥ã‚’è¿½åŠ ã—ã¦ãã ã•ã„</li></ul>
  <p id="flyer-time">æ™‚é–“ï¼š13:30â€“16:30</p>
  <p id="flyer-price">å‚åŠ è²»ï¼š1,500å††</p>
</div>

<button onclick="downloadPDF()">ğŸ“„ PDFä¿å­˜</button>

<script>
function addEvent(){
  const div=document.createElement('div');
  div.className='event-block';
  div.innerHTML='<input type="date" class="event-date"><input type="text" class="event-region" placeholder="åœ°åŸŸ"><input type="text" class="event-venue" placeholder="ä¼šå ´">';
  document.getElementById('events').appendChild(div);
}
addEvent();

function getPurposes(){
  return [...document.querySelectorAll('input[name=purpose]:checked')].map(el=>el.value);
}

function makePrompt(){
  const data={
    year:year.value,
    audience:target.value,
    purpose:getPurposes().join("ãƒ»")||"å®‰å¿ƒãƒ»äº¤æµ",
    price:price.value,
    time:time.value,
    count:document.querySelectorAll('.event-block').length
  };
  const txt=`ã‚ãªãŸã¯ã‚„ã•ã—ãä¿¡é ¼æ„Ÿã®ã‚ã‚‹åºƒå ±æ‹…å½“è€…ã§ã™ã€‚
ä»¥ä¸‹ãƒ‡ãƒ¼ã‚¿ã§A4ãƒãƒ©ã‚·ç”¨ã‚³ãƒ”ãƒ¼ã‚’JSONå½¢å¼ã§ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚

å¹´åº¦: ${data.year}
å¯¾è±¡è€…: ${data.audience}
è¬›åº§ç›®çš„: ${data.purpose}
å‚åŠ è²»: ${data.price}
æ™‚é–“: ${data.time}
é–‹å‚¬å›æ•°: ${data.count}

<<å‡ºåŠ›>>
{
  "title": "20æ–‡å­—ä»¥å†…",
  "catch": "20æ–‡å­—ä»¥å†…",
  "body": "3ã€œ4è¡Œ",
  "imagePrompt": ""
}`;
  promptBox.value=txt.trim();
}

function copyPrompt(){
  navigator.clipboard.writeText(promptBox.value).then(()=>alert("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ"));
}

function applyAI(){
  let obj;
  try{ obj=JSON.parse(aiReply.value) }catch{ alert("JSONãŒä¸æ­£ã§ã™"); return;}
  flyerTitle.textContent=obj.title||flyerTitle.textContent;
  flyerCatch.textContent=obj.catch||flyerCatch.textContent;
  flyerBody.textContent=obj.body||flyerBody.textContent;
}

function refreshEvents(){
  const list=[...document.querySelectorAll('.event-block')].map((b,i)=>{
    const d=b.querySelector('.event-date').value;
    const r=b.querySelector('.event-region').value;
    const v=b.querySelector('.event-venue').value;
    if(d&&r&&v){return `ç¬¬${i+1}å›ï¼š${new Date(d).toLocaleDateString('ja-JP')}ï¼ˆ${r}/${v}ï¼‰`;}
    return null;
  }).filter(Boolean);
  flyerEvents.innerHTML='<li>'+list.join('</li><li>')+'</li>';
}
document.getElementById('events').addEventListener('input',refreshEvents);

function downloadPDF(){
  html2pdf().from(document.getElementById('preview')).set({filename:'flyer.pdf',html2canvas:{scale:2},jsPDF:{unit:'mm',format:'a4'}}).save();
}
</script>
</body>
</html>
